package benmcavoy.hcdemo;

import benmcavoy.hcdemo.reflection.Documentation;
import benmcavoy.hcdemo.reflection.Name;
import net.minecraft.client.MinecraftClient;
import net.minecraft.client.gui.hud.ChatHud;
import net.minecraft.text.Text;

public abstract class Exploit {
    // Metadata
    public String name;
    public String description;

    public ExploitState state = ExploitState.UNUSED;
    public MinecraftClient client = MinecraftClient.getInstance();

    // Constructor
    // Use reflection to get the name of the exploit
    public Exploit() {
        Name name = this.getClass().getAnnotation(Name.class);
        if (name != null) {
            this.name = name.value();
        } else {
            this.name = this.getClass().getSimpleName();
        }

        Documentation annotation = this.getClass().getAnnotation(Documentation.class);

        if (annotation != null) {
            this.description = annotation.value();
        } else {
            this.description = "None";
        }
    }

    public void Toggle() {
        if (this.state == ExploitState.UNUSED) {
            SetState(ExploitState.ON);
        } else if (this.state == ExploitState.ON) {
            SetState(ExploitState.OFF);
        } else if (this.state == ExploitState.OFF) {
            SetState(ExploitState.ON);
        }
    }

    public void SetState(ExploitState state) {
        this.state = state;

        if (state == ExploitState.ON) {
            ChatHud chatHud = client.inGameHud.getChatHud();
            chatHud.addMessage(Text.of(this.name + " enabled"));
            chatHud.addMessage(Text.of("Description: " + this.description));
            onEnable();
        } else if (state == ExploitState.OFF) {
            client.inGameHud.getChatHud().addMessage(Text.of(this.name + " disabled"));
            onDisable();
        }
    }

    protected void OnTick() {}

    protected void onEnable() {}
    protected void onDisable() {}
}